
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Stats: Fundamentals of Statistical Process Monitoring &#8212; Data Science for Engineers</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Grama: Fitting Univariate Distributions" href="d23-e-grama06-fit-univar-solution.html" />
    <link rel="prev" title="Stats: Confidence Intervals and the CLT" href="d21-e-stat05-CI-solution.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Data Science for Engineers</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../frontmatter/home.html">
                    Data Science for Engineers
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../frontmatter/setup.html">
   Software Setup
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../frontmatter/howto.html">
   How To Use These Materials
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../frontmatter/schedule.html">
   Course Topics and Schedule
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../frontmatter/submission.html">
   Challenge Submission Instructions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../frontmatter/recordings.html">
   Class Recordings
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../frontmatter/demos.html">
   Demo Notebooks
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../demos/demo2022-06-20-1.html">
     Demo Notebook 2022-06-20
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../demos/demo2022-06-27.html">
     Demo Notebook 2022-06-27
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../demos/demo2022-07-06.html">
     Demo Notebook 2022-07-06
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../frontmatter/hours.html">
   Office Hours Schedule
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../frontmatter/exercises.html">
   Exercise Solutions
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="d01-e-data00-notebooks-solution.html">
     Introduction to Jupyter Notebooks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="d01-e-vis00-basics-solution.html">
     Vis: Data Visualization Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="d02-e-data01-isolate-solution.html">
     Data: Isolating Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="d02-e-tips-solution.html">
     Tips for This Course
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="d03-e-stat01-eda-solution.html">
     Stats: Introduction to Exploratory Data Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="d04-e-grama01-basics-solution.html">
     Grama: Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="d05-e-vis01-bar-charts-solution.html">
     Vis: Bar Charts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="d06-e-data02-derive-solution.html">
     Data: Deriving Quantities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="d07-e-vis02-histograms-solution.html">
     Vis: Histograms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="d08-e-stat02-source-solution.html">
     Stats: Real and Erroneous Sources of Variability
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="d09-e-vis03-scatterplot-solution.html">
     Vis: Scatterplots and Layers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="d10-e-grama02-building-solution.html">
     Grama: Model Building
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="d11-e-data03-pivot-solution.html">
     Data: Pivoting Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="d12-e-grama03-eval-solution.html">
     Grama: Model Evaluation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="d13-e-vis04-lines-solution.html">
     Vis: Lines and Related Geometries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="d14-e-stat03-descriptive-solution.html">
     Stats: Descriptive Statistics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="d15-e-data04-separate-unite-solution.html">
     Data: Separating and Uniting Columns
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="d16-e-data05-join-solution.html">
     Data: Joining Datasets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="d17-e-vis05-multiples-solution.html">
     Vis: Small Multiples
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="d18-e-grama04-ema-solution.html">
     Grama: Exploratory Model Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="d19-e-stat04-distributions-solution.html">
     Stats: Distributions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="d20-e-grama05-fit-function-solution.html">
     Grama: Fitting Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="d21-e-stat05-CI-solution.html">
     Stats: Confidence Intervals and the CLT
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Stats: Fundamentals of Statistical Process Monitoring
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="d23-e-grama06-fit-univar-solution.html">
     Grama: Fitting Univariate Distributions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="d24-e-grama07-fit-multivar-solution.html">
     Grama: Fitting Multivariate Distributions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="d25-e-grama08-duu-solution.html">
     Grama: Design Under Uncertainty
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/exercises_solution/d22-e-stat06-spc-solution.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/exercises_solution/d22-e-stat06-spc-solution.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Stats: Fundamentals of Statistical Process Monitoring
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setup">
     Setup
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#theory">
   Theory
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#x-bar-and-s-chart">
     X-bar and S Chart
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#batch-averages">
     Batch Averages
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#control-limits-confidence-intervals">
     Control limits: Confidence Intervals
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#grouping-observations">
     Grouping observations
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#natural-batches">
       Natural batches
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#q0-conceptual-questions">
       <strong>
        q0
       </strong>
       Conceptual questions
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#q1-batch-by-machine">
       <strong>
        q1
       </strong>
       Batch by machine
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#batches-in-time">
       Batches in time
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#q2-create-consecutive-groups">
       <strong>
        q2
       </strong>
       Create consecutive groups
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#q3-batch-by-slices-of-time">
       <strong>
        q3
       </strong>
       Batch by slices of time
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#naive-consecutive-rows">
     Naive consecutive rows
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#patterns-to-seek">
   Patterns to seek
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#outside-control-limits">
     Outside control limits
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#variability-out-of-control">
     Variability out-of-control
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#runs-above-center">
     Runs above center
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#runs-below-center">
     Runs below center
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#runs-increasing">
     Runs increasing
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#runs-decreasing">
     Runs decreasing
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#warnings">
   Warnings
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#beware-spurious-patterns">
     Beware spurious patterns!
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#beware-meaningless-order">
     Beware meaningless order
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-cast-aluminum-dataset">
   Example: Cast Aluminum Dataset
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q4-assess-the-density">
     <strong>
      q4
     </strong>
     Assess the
     <code class="docutils literal notranslate">
      <span class="pre">
       density
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q5-assess-the-tensile-strength">
     <strong>
      q5
     </strong>
     Assess the
     <code class="docutils literal notranslate">
      <span class="pre">
       tensile_strength
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Stats: Fundamentals of Statistical Process Monitoring</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Stats: Fundamentals of Statistical Process Monitoring
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setup">
     Setup
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#theory">
   Theory
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#x-bar-and-s-chart">
     X-bar and S Chart
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#batch-averages">
     Batch Averages
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#control-limits-confidence-intervals">
     Control limits: Confidence Intervals
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#grouping-observations">
     Grouping observations
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#natural-batches">
       Natural batches
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#q0-conceptual-questions">
       <strong>
        q0
       </strong>
       Conceptual questions
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#q1-batch-by-machine">
       <strong>
        q1
       </strong>
       Batch by machine
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#batches-in-time">
       Batches in time
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#q2-create-consecutive-groups">
       <strong>
        q2
       </strong>
       Create consecutive groups
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#q3-batch-by-slices-of-time">
       <strong>
        q3
       </strong>
       Batch by slices of time
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#naive-consecutive-rows">
     Naive consecutive rows
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#patterns-to-seek">
   Patterns to seek
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#outside-control-limits">
     Outside control limits
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#variability-out-of-control">
     Variability out-of-control
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#runs-above-center">
     Runs above center
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#runs-below-center">
     Runs below center
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#runs-increasing">
     Runs increasing
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#runs-decreasing">
     Runs decreasing
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#warnings">
   Warnings
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#beware-spurious-patterns">
     Beware spurious patterns!
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#beware-meaningless-order">
     Beware meaningless order
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-cast-aluminum-dataset">
   Example: Cast Aluminum Dataset
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q4-assess-the-density">
     <strong>
      q4
     </strong>
     Assess the
     <code class="docutils literal notranslate">
      <span class="pre">
       density
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q5-assess-the-tensile-strength">
     <strong>
      q5
     </strong>
     Assess the
     <code class="docutils literal notranslate">
      <span class="pre">
       tensile_strength
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="stats-fundamentals-of-statistical-process-monitoring">
<h1>Stats: Fundamentals of Statistical Process Monitoring<a class="headerlink" href="#stats-fundamentals-of-statistical-process-monitoring" title="Permalink to this headline">#</a></h1>
<p><em>Purpose</em>: In future exercises we’re going to learn how to model variable quantities as random, but before we do that, we need tools to help decide if a given quantity <em>should</em> be modeled as random. The tools of <em>statistical process monitoring</em> (sometimes called <em>statistical process control</em>) will help us find non-random patterns in data, which can be helpful for deciding whether or not a quantity can be reasonably modeled as random.</p>
<section id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">grama</span> <span class="k">as</span> <span class="nn">gr</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">DF</span> <span class="o">=</span> <span class="n">gr</span><span class="o">.</span><span class="n">Intention</span><span class="p">()</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="theory">
<h1>Theory<a class="headerlink" href="#theory" title="Permalink to this headline">#</a></h1>
<p>It’s difficult to tell by-inspection if data are random. For example, let’s look at a completely random dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## NOTE: No need to edit; run and inspect</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">102</span><span class="p">)</span>

<span class="n">mg_normal</span> <span class="o">=</span> <span class="n">gr</span><span class="o">.</span><span class="n">marg_mom</span><span class="p">(</span><span class="s2">&quot;norm&quot;</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sd</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_random</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">gr</span><span class="o">.</span><span class="n">df_make</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">mg_normal</span><span class="o">.</span><span class="n">r</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_mutate</span><span class="p">(</span><span class="n">idx</span><span class="o">=</span><span class="n">DF</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="p">)</span>

<span class="p">(</span>
    <span class="n">df_random</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">ggplot</span><span class="p">(</span><span class="n">gr</span><span class="o">.</span><span class="n">aes</span><span class="p">(</span><span class="s2">&quot;idx&quot;</span><span class="p">,</span> <span class="s2">&quot;X&quot;</span><span class="p">))</span>
    <span class="o">+</span> <span class="n">gr</span><span class="o">.</span><span class="n">geom_point</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d22-e-stat06-spc-solution_5_0.png" src="../_images/d22-e-stat06-spc-solution_5_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (8763723758912)&gt;
</pre></div>
</div>
</div>
</div>
<p>Some observations:</p>
<ul class="simple">
<li><p>Without some sense of <em>reasonable limits</em>, we can’t distinguish outliers from the normal highs and lows of randomness.</p></li>
<li><p>Without some knowledge of the underlying random process, we cannot define reasonable limits.</p></li>
</ul>
<p>Rather than do concentrated staring at random patterns, we can make some <em>intelligent choices</em> about grouping observations, and use <em>batch averages</em> to set meaningful <em>control limits</em>. These ideas combine in a <em>control chart</em>; the following plot is our first example of a control chart.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display
<span class="c1">## NOTE: No need to edit</span>

<span class="p">(</span>
    <span class="n">df_random</span> 
    <span class="c1">## Group observations into consecutive batches of 10</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_mutate</span><span class="p">(</span><span class="n">id_batch</span><span class="o">=</span><span class="n">DF</span><span class="o">.</span><span class="n">index</span> <span class="o">//</span> <span class="mi">10</span><span class="p">)</span>
    <span class="c1">## Construct an Xbar and S (xbs) chart</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">pt_xbs</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;id_batch&quot;</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d22-e-stat06-spc-solution_8_0.png" src="../_images/d22-e-stat06-spc-solution_8_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (8763723979319)&gt;
</pre></div>
</div>
</div>
</div>
<p>From this chart, we see no outliers outside the lower control limit (LCL) or upper control limit (UCL). We also don’t see any special patterns in the data. Therefore, based on this control chart, we can declare that the process is likely under <em>statistical control</em>—that it can be modeled as random.</p>
<section id="x-bar-and-s-chart">
<h2>X-bar and S Chart<a class="headerlink" href="#x-bar-and-s-chart" title="Permalink to this headline">#</a></h2>
<p>The helper function <code class="docutils literal notranslate"><span class="pre">gr.pt_xbs()</span></code> constructs a particular kind of control chart: an X-bar and S chart. This shows both the <em>batch</em> sample standard deviation (S) and <em>batch</em> sample mean (X-bar), along with <em>control limits</em> for these quantities. This statistical tool helps us find suspicious patterns in a dataset.</p>
<p>In order to understand X-bar and S charts, we need understand why we take <em>batch averages</em>, and how to construct meaningful <em>control limits</em> for X-bar and S.</p>
</section>
<section id="batch-averages">
<h2>Batch Averages<a class="headerlink" href="#batch-averages" title="Permalink to this headline">#</a></h2>
<p>We saw before that the <em>sample mean</em> follows the central limit theorem, which tells us about the distribution of the sample mean if we were to observe multiple, independent datasets. Thus taking the average of multiple observations <em>from the same process</em> gives us a way to make the underlying distribution more predictable.</p>
<p>However, taking the average of <em>all</em> observations <span class="math notranslate nohighlight">\(n_{\text{total}}\)</span> prevents us from determining <em>where</em> an outlier occurred: If the mean of all the data is high, was it the first observation that was large? The last one? Something in the middle?</p>
<p>Therefore, we’ll split the data into batches of a much smaller size <span class="math notranslate nohighlight">\(n_{\text{batch}} &lt;&lt; n_{\text{total}}\)</span>. Taking <em>batch averages</em> gives us better resolution (allowing us to determine which batch is worth further investigation), while still giving the advantages of the central limit theorem.</p>
</section>
<section id="control-limits-confidence-intervals">
<h2>Control limits: Confidence Intervals<a class="headerlink" href="#control-limits-confidence-intervals" title="Permalink to this headline">#</a></h2>
<p>Remember (from <a class="reference external" href="https://zdelrosario.github.io/evc-course/exercises_solution/d21-e-stat05-CI-solution.html">e-stat05-CI</a>) that the central limit theorem-based confidence interval for the sample mean is given by</p>
<div class="math notranslate nohighlight">
\[[\overline{X}_n - z_C \sigma/\sqrt{n}, \overline{X}_n + z_C \sigma/\sqrt{n}]\]</div>
<p>where <span class="math notranslate nohighlight">\(z_C\)</span> is the relevant quantile of a standard normal distribution, and <span class="math notranslate nohighlight">\(n\)</span> is the number of observations in our sample. For control charts, it is standard to choose a very strict confidence level of <span class="math notranslate nohighlight">\(C = 1 - 1/1000\)</span>.</p>
<p>To understand how we will <em>use</em> the idea of confidence intervals to look for non-random patterns, let’s remind ourselves of the <em>golden rule for interpreting confidence intervals</em>:</p>
<div class="admonition-the-golden-rule-for-interpreting-confidence-intervals admonition">
<p class="admonition-title">The “Golden Rule” for interpreting Confidence Intervals</p>
<p>When interpreting a confidence interval, we should assume the true value could be anywhere inside the interval.</p>
</div>
<p>With a control chart, we want to be able to tell <em>when</em> a pattern in the data looked non-random. To that end, we’ll study the sample means of small <em>batches</em> of the data, and compare all of those batches to a single confidence interval. Since the confidence interval is a reasonable range for the true value, we will flag batch means that fall outside the confidence interval as potentially non-random, and worth of further investigation.</p>
<p>When constructing a control chart, we use the <em>entire</em> dataset to estimate the mean <span class="math notranslate nohighlight">\(\overline{X}_{n_{\text{total}}}\)</span> and standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span>, but construct the confidence interval based on the batch size <span class="math notranslate nohighlight">\(n_{\text{batch}}\)</span>. That looks like:</p>
<div class="math notranslate nohighlight">
\[[\overline{X}_{n_{\text{total}}} - z_C \sigma/\sqrt{n_{\text{batch}}}, \overline{X}_{n_{\text{total}}} + z_C \sigma/\sqrt{n_{\text{batch}}}]\]</div>
<p>The helper function <code class="docutils literal notranslate"><span class="pre">gr.pt_xbs()</span></code> automates the approximation of these control limits. In the rest of this exercise, we’ll focus on grouping the observations into reasonable batches.</p>
<div class="admonition-see-the-references-for-the-gory-statistical-details admonition">
<p class="admonition-title">See the references for the gory statistical details</p>
<p>When it comes to approximating the standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span> for a control chart, there is actually a bit more work we have to do to <em>de-bias</em> the standard deviation. The control limits for the standard deviation also follow a different formula than the sample mean. For more details, see the references listed at the bottom of this exercise.</p>
</div>
</section>
<section id="grouping-observations">
<h2>Grouping observations<a class="headerlink" href="#grouping-observations" title="Permalink to this headline">#</a></h2>
<p>Ideally, the selection of batches should be made during the <em>planning</em> of data collection. If we are studying archival data, we can sometimes make some reasonable assumptions about data collection in order to define batches.</p>
<section id="natural-batches">
<h3>Natural batches<a class="headerlink" href="#natural-batches" title="Permalink to this headline">#</a></h3>
<p>In cases when we can <em>plan</em> data collection, there are likely candidates for “natural” batches of data. For instance, if we have multiple machines that are used (separately) to make the same part, we could group observations based on which machine led to their manufacture.</p>
<p>The next code chunk simulates data where multiple machines are used to manufacture the same part—one of the machines is malfunctioning. You’ll use a control chart to help determine which machine is causing problems.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## NOTE: No need to edit</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>

<span class="n">df_base</span> <span class="o">=</span> <span class="n">gr</span><span class="o">.</span><span class="n">df_make</span><span class="p">(</span>
    <span class="n">sd</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span>
    <span class="n">ma</span><span class="o">=</span><span class="p">[</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span>  <span class="s2">&quot;B&quot;</span><span class="p">,</span>  <span class="s2">&quot;C&quot;</span><span class="p">,</span>  <span class="s2">&quot;D&quot;</span><span class="p">,</span>  <span class="s2">&quot;E&quot;</span><span class="p">,</span>  <span class="s2">&quot;F&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">mg</span> <span class="o">=</span> <span class="n">gr</span><span class="o">.</span><span class="n">marg_mom</span><span class="p">(</span><span class="s2">&quot;norm&quot;</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sd</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">df_machines</span> <span class="o">=</span> <span class="n">gr</span><span class="o">.</span><span class="n">df_grid</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">df_base</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">df_machines</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">df_machines</span>
        <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_bind_rows</span><span class="p">(</span>
            <span class="n">gr</span><span class="o">.</span><span class="n">df_make</span><span class="p">(</span>
                <span class="n">X</span><span class="o">=</span><span class="n">mg</span><span class="o">.</span><span class="n">r</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="o">*</span> <span class="n">df_base</span><span class="o">.</span><span class="n">sd</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="n">id_machine</span><span class="o">=</span><span class="n">df_base</span><span class="o">.</span><span class="n">ma</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="c1"># Randomly sort</span>
<span class="n">df_machines</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df_machines</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="q0-conceptual-questions">
<h3><strong>q0</strong> Conceptual questions<a class="headerlink" href="#q0-conceptual-questions" title="Permalink to this headline">#</a></h3>
<p>Before we start constructing control charts, let’s check your understanding with some conceptual questions. Run the code below, and answer the questions under <em>observations</em> below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## TODO: No need to edit this code; run and inspect</span>
<span class="p">(</span>
    <span class="n">df_machines</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_count</span><span class="p">(</span><span class="n">DF</span><span class="o">.</span><span class="n">id_machine</span><span class="p">)</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_bind_rows</span><span class="p">(</span>
        <span class="n">df_machines</span>
        <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_summarize</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">gr</span><span class="o">.</span><span class="n">n</span><span class="p">())</span>
        <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_mutate</span><span class="p">(</span><span class="n">id_machine</span><span class="o">=</span><span class="s2">&quot;(Total)&quot;</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_machine</th>
      <th>n</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>15</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>15</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C</td>
      <td>15</td>
    </tr>
    <tr>
      <th>3</th>
      <td>D</td>
      <td>15</td>
    </tr>
    <tr>
      <th>4</th>
      <td>E</td>
      <td>15</td>
    </tr>
    <tr>
      <th>5</th>
      <td>F</td>
      <td>15</td>
    </tr>
    <tr>
      <th>6</th>
      <td>(Total)</td>
      <td>90</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><em>Observations</em></p>
<ul class="simple">
<li><p>If we set the grouping according to the column <code class="docutils literal notranslate"><span class="pre">id_machine</span></code>, what value of <code class="docutils literal notranslate"><span class="pre">n</span></code> should we use to compute the <em>control limits</em>? (That is, the factor of <span class="math notranslate nohighlight">\(1/\sqrt{n}\)</span>.)</p>
<ul>
<li><p>Since there are <code class="docutils literal notranslate"><span class="pre">n=15</span></code> values in each group, we should set <code class="docutils literal notranslate"><span class="pre">n_batch</span> <span class="pre">==</span> <span class="pre">15</span></code>.</p></li>
</ul>
</li>
<li><p>To construct a control chart, we need to compute <em>control limits</em> based on the variance of the data. What number of observations is used to compute the variance?</p>
<ul>
<li><p>The variance should be estimated based on the entire dataset, which has <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">==</span> <span class="pre">90</span></code>.</p></li>
</ul>
</li>
</ul>
<!-- solution-end --></section>
<section id="q1-batch-by-machine">
<h3><strong>q1</strong> Batch by machine<a class="headerlink" href="#q1-batch-by-machine" title="Permalink to this headline">#</a></h3>
<p>Construct a control chart using the machine identifier as the <code class="docutils literal notranslate"><span class="pre">group</span></code> variable. Look for patterns in the measured quantity <code class="docutils literal notranslate"><span class="pre">X</span></code>. Answer the questions under <em>observations</em> below.</p>
<p><em>Hint</em>: Remember to read the documentation for an unfamiliar function to learn about its arguments.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display
<span class="c1">## TODO: Create a control chart grouped by machine</span>
<span class="p">(</span>
    <span class="n">df_machines</span>
<span class="c1"># solution-begin    </span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">pt_xbs</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;id_machine&quot;</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
<span class="c1"># solution-end    </span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d22-e-stat06-spc-solution_21_0.png" src="../_images/d22-e-stat06-spc-solution_21_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (8763671329196)&gt;
</pre></div>
</div>
</div>
</div>
<p><em>Observations</em></p>
<ul class="simple">
<li><p>Based on the batch size you chose, did you find any out-of-control patterns?</p>
<ul>
<li><p>Yes, I see out-of-control variability for Machine B.</p></li>
</ul>
</li>
<li><p>If you answered “yes” to the previous question, does your group variable give you a meaningful way to determine what may have cause the out-of-control pattern?</p>
<ul>
<li><p>Yes! Batching by machine gives us an obvious clue about where the out-of-control behavior occurred.</p></li>
</ul>
</li>
</ul>
<!-- solution-end --></section>
<section id="batches-in-time">
<h3>Batches in time<a class="headerlink" href="#batches-in-time" title="Permalink to this headline">#</a></h3>
<p>Natural batches—such as per-machine as above—are a fine way to choose the grouping for a control chart. However, there are other ways to batch the data.</p>
<p>Another way to batch the data is by <em>consecutive periods of time</em>; this can be helpful for monitoring a single data-generating process to see if something happened at a particular point in time.</p>
<p>When choosing consecutive observations, we should choose <em>reasonable</em> batch sizes <span class="math notranslate nohighlight">\(n_{\text{batch}}\)</span>. The following rule of thumb is helpful for picking a reasonable <span class="math notranslate nohighlight">\(n_{\text{batch}}\)</span>.</p>
<blockquote>
<div><p>A rule of thumb is to use three time periods with 20 to 25 samples of size <span class="math notranslate nohighlight">\(n_{\text{batch}} = 50\)</span> to <span class="math notranslate nohighlight">\(n_{\text{batch}} = 100\)</span> units each.</p>
</div></blockquote>
<p>The following code simulates data from a process that varies over time. The data collection plans for 45 samples, each containing <span class="math notranslate nohighlight">\(n_{\text{batch}} = 50\)</span> observations. This results in <code class="docutils literal notranslate"><span class="pre">45</span> <span class="pre">*</span> <span class="pre">50</span> <span class="pre">=</span> <span class="pre">2250</span></code> observations total.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## NOTE: No need to edit</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>

<span class="n">df_base</span> <span class="o">=</span> <span class="n">gr</span><span class="o">.</span><span class="n">df_make</span><span class="p">(</span>
    <span class="n">mu</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">30</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">gr</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">15</span><span class="p">)),</span>
<span class="p">)</span>
<span class="n">mg</span> <span class="o">=</span> <span class="n">gr</span><span class="o">.</span><span class="n">marg_mom</span><span class="p">(</span><span class="s2">&quot;norm&quot;</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sd</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">df_time</span> <span class="o">=</span> <span class="n">gr</span><span class="o">.</span><span class="n">df_grid</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">df_base</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">df_time</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">df_time</span>
        <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_bind_rows</span><span class="p">(</span>
            <span class="n">gr</span><span class="o">.</span><span class="n">df_make</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">mg</span><span class="o">.</span><span class="n">r</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="o">+</span> <span class="n">df_base</span><span class="o">.</span><span class="n">mu</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="c1"># Randomly sort</span>
<span class="n">df_time</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df_time</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_mutate</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">DF</span><span class="o">.</span><span class="n">index</span><span class="o">/</span><span class="n">gr</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">DF</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="q2-create-consecutive-groups">
<h3><strong>q2</strong> Create consecutive groups<a class="headerlink" href="#q2-create-consecutive-groups" title="Permalink to this headline">#</a></h3>
<p>Use a mutate to create a column <code class="docutils literal notranslate"><span class="pre">id_seq</span></code> to group sequential observations.</p>
<p><em>Hint 1</em>: Remember that floor division <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">//</span> <span class="pre">y</span></code> is one way to create sequential values.</p>
<p><em>Hint 2</em>: Remember that <code class="docutils literal notranslate"><span class="pre">DF.index</span></code> allows you to access the index of each row in a DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## TASK: Create a column `id_seq` to group sequential observations</span>
<span class="n">df_seq</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df_time</span>

    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_mutate</span><span class="p">(</span><span class="n">id_seq</span><span class="o">=</span><span class="n">DF</span><span class="o">.</span><span class="n">index</span> <span class="o">//</span> <span class="mi">50</span><span class="p">)</span>
<span class="c1"># solution-end    </span>
<span class="p">)</span>

<span class="c1">## NOTE: Use this to check your work</span>
<span class="k">assert</span> \
    <span class="s2">&quot;id_seq&quot;</span> <span class="ow">in</span> <span class="n">df_seq</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> \
    <span class="s2">&quot;df_seq does not have a column `id_seq`&quot;</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;You grouped the observations into </span><span class="si">{0:}</span><span class="s2"> samples of size n_batch = </span><span class="si">{1:}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">df_seq</span><span class="o">.</span><span class="n">id_seq</span><span class="p">)),</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">df_seq</span><span class="p">[</span><span class="n">df_seq</span><span class="o">.</span><span class="n">id_seq</span> <span class="o">==</span> <span class="n">df_seq</span><span class="o">.</span><span class="n">id_seq</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]]),</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df_seq</span> <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_head</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>You grouped the observations into 45 samples of size n_batch = 50
           X         t  id_seq
0   2.605316  0.801333       0
1  -0.234766  0.080444       0
2  -0.950839  0.888889       0
3  -1.340159  0.527556       0
4   0.563586  0.999556       0
5   0.372806  0.253778       0
6   1.378403  0.080000       0
7   1.031736  0.288000       0
8   0.639372  0.916889       0
9   1.186054  0.336000       0
10  0.083397  0.545333       0
11 -0.683701  0.935556       0
12 -0.388190  0.505333       0
13  0.139908  0.761333       0
14  0.978535  0.296444       0
15 -0.187721  0.272889       0
16 -0.063713  0.812444       0
17  0.759567  0.749778       0
18  0.087531  0.587111       0
19  0.150913  0.484889       0
</pre></div>
</div>
</div>
</div>
</section>
<section id="q3-batch-by-slices-of-time">
<h3><strong>q3</strong> Batch by slices of time<a class="headerlink" href="#q3-batch-by-slices-of-time" title="Permalink to this headline">#</a></h3>
<p>Sort the data by time <code class="docutils literal notranslate"><span class="pre">t</span></code>, then batch the observations into consecutive groups and construct a control chart.</p>
<p>Make sure to <em>match</em> the batch size <span class="math notranslate nohighlight">\(n_{\text{batch}}\)</span> used in data collection.</p>
<p>Answer the questions under <em>observations</em> below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display
<span class="c1">## TODO: Arrange the dataset by time `t` and batch appropriately</span>
<span class="n">df_timebatch</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df_time</span>
<span class="c1"># solution-begin    </span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_arrange</span><span class="p">(</span><span class="n">DF</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_mutate</span><span class="p">(</span><span class="n">id_seq</span><span class="o">=</span><span class="n">DF</span><span class="o">.</span><span class="n">index</span> <span class="o">//</span> <span class="mi">50</span><span class="p">)</span>
<span class="c1"># solution-end    </span>
<span class="p">)</span>

<span class="c1">## NOTE: No need to edit; use this to check your work</span>
<span class="k">assert</span> \
    <span class="s2">&quot;id_seq&quot;</span> <span class="ow">in</span> <span class="n">df_timebatch</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> \
    <span class="s2">&quot;df_timebatch does not have a column `id_seq`&quot;</span>

<span class="k">assert</span> \
    <span class="nb">len</span><span class="p">(</span><span class="n">df_timebatch</span><span class="p">[</span><span class="n">df_timebatch</span><span class="o">.</span><span class="n">id_seq</span> <span class="o">==</span> <span class="n">df_timebatch</span><span class="o">.</span><span class="n">id_seq</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span> <span class="o">==</span> <span class="mi">50</span><span class="p">,</span> \
    <span class="s2">&quot;You did not choose a batch size n_batch that matches the data collection&quot;</span>
    
<span class="c1"># Visualize</span>
<span class="p">(</span>
    <span class="n">df_timebatch</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">pt_xbs</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;id_seq&quot;</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d22-e-stat06-spc-solution_28_0.png" src="../_images/d22-e-stat06-spc-solution_28_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (8763708800699)&gt;
</pre></div>
</div>
</div>
</div>
<p><em>Observations</em></p>
<p><em>Hint</em>: You will <em>not</em> see any patterns if you do not properly arrange the data.</p>
<ul class="simple">
<li><p>Based on the batch size you chose, did you find any out-of-control patterns?</p>
<ul>
<li><p>Arranged by time and with a batch size of <code class="docutils literal notranslate"><span class="pre">n=50</span></code>, I see one low mean and a long string of high-mean batches.</p></li>
</ul>
</li>
<li><p>If you answered “yes” to the previous question, does your group variable give you a meaningful way to determine what may have cause the out-of-control pattern?</p>
<ul>
<li><p>Yes; since the batches are arranged in time, we can see that the process was trending upward in time towards the end of the period.</p></li>
</ul>
</li>
</ul>
<!-- solution-end --></section>
</section>
<section id="naive-consecutive-rows">
<h2>Naive consecutive rows<a class="headerlink" href="#naive-consecutive-rows" title="Permalink to this headline">#</a></h2>
<p>What happens if we do not correctly arrange the rows? Then we lose all information about the time history of the data. The following plot shows what happens if we construct a control chart without respecting the time ordering of the data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display
<span class="c1">## NOTE: No need to edit; run and inspect</span>
<span class="p">(</span>
    <span class="n">df_time</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_mutate</span><span class="p">(</span><span class="n">id_batch</span><span class="o">=</span><span class="n">DF</span><span class="o">.</span><span class="n">index</span> <span class="o">//</span> <span class="mi">50</span><span class="p">)</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">pt_xbs</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;id_batch&quot;</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d22-e-stat06-spc-solution_31_0.png" src="../_images/d22-e-stat06-spc-solution_31_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (8763708846577)&gt;
</pre></div>
</div>
</div>
</div>
<p>Note that there are no patterns in this view of the data!</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="patterns-to-seek">
<h1>Patterns to seek<a class="headerlink" href="#patterns-to-seek" title="Permalink to this headline">#</a></h1>
<p>Kenett and Zacks (2014) highlight several patterns that can signal an out-of-control manufacturing process:</p>
<blockquote>
<div><ol class="simple">
<li><p>A single point outside the control limits.</p></li>
<li><p>A run of nine or more points in a row above (or below) the centerline.</p></li>
<li><p>Six consecutive points increasing (trend up) or decreasing (trend down).</p></li>
</ol>
</div></blockquote>
<p>The following cells simulate data to illustrate each of these patterns.</p>
<section id="outside-control-limits">
<h2>Outside control limits<a class="headerlink" href="#outside-control-limits" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display
<span class="c1">## NOTE: No need to edit</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">mu</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">15</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">1</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">15</span> 
<span class="n">mg_standard</span> <span class="o">=</span> <span class="n">gr</span><span class="o">.</span><span class="n">marg_mom</span><span class="p">(</span><span class="s2">&quot;norm&quot;</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sd</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">df_outlier</span> <span class="o">=</span> <span class="n">gr</span><span class="o">.</span><span class="n">df_grid</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mu</span><span class="p">):</span>
    <span class="n">df_outlier</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">df_outlier</span>
        <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_bind_rows</span><span class="p">(</span><span class="n">gr</span><span class="o">.</span><span class="n">df_make</span><span class="p">(</span>
            <span class="n">X</span><span class="o">=</span><span class="n">mg_standard</span><span class="o">.</span><span class="n">r</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">m</span>
        <span class="p">))</span>
    <span class="p">)</span>
    
<span class="p">(</span>
    <span class="n">df_outlier</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_mutate</span><span class="p">(</span><span class="n">idx</span><span class="o">=</span><span class="n">DF</span><span class="o">.</span><span class="n">index</span> <span class="o">//</span> <span class="n">n</span><span class="p">)</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">pt_xbs</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;idx&quot;</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d22-e-stat06-spc-solution_35_0.png" src="../_images/d22-e-stat06-spc-solution_35_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (8763671402325)&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="variability-out-of-control">
<h2>Variability out-of-control<a class="headerlink" href="#variability-out-of-control" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display
<span class="c1">## NOTE: No need to edit</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">mu</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">30</span>
<span class="n">mg_standard</span> <span class="o">=</span> <span class="n">gr</span><span class="o">.</span><span class="n">marg_mom</span><span class="p">(</span><span class="s2">&quot;norm&quot;</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sd</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">df_outlier</span> <span class="o">=</span> <span class="n">gr</span><span class="o">.</span><span class="n">df_grid</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mu</span><span class="p">):</span>
    <span class="n">df_outlier</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">df_outlier</span>
        <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_bind_rows</span><span class="p">(</span><span class="n">gr</span><span class="o">.</span><span class="n">df_make</span><span class="p">(</span>
            <span class="n">X</span><span class="o">=</span><span class="n">mg_standard</span><span class="o">.</span><span class="n">r</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">20</span><span class="p">))</span> <span class="o">+</span> <span class="n">m</span>
        <span class="p">))</span>
    <span class="p">)</span>
    
<span class="p">(</span>
    <span class="n">df_outlier</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_mutate</span><span class="p">(</span><span class="n">idx</span><span class="o">=</span><span class="n">DF</span><span class="o">.</span><span class="n">index</span> <span class="o">//</span> <span class="n">n</span><span class="p">)</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">pt_xbs</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;idx&quot;</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d22-e-stat06-spc-solution_37_0.png" src="../_images/d22-e-stat06-spc-solution_37_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (8763708668823)&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="runs-above-center">
<h2>Runs above center<a class="headerlink" href="#runs-above-center" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display
<span class="c1">## NOTE: No need to edit</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">mu</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">15</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">15</span> 
<span class="n">mg_standard</span> <span class="o">=</span> <span class="n">gr</span><span class="o">.</span><span class="n">marg_mom</span><span class="p">(</span><span class="s2">&quot;norm&quot;</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sd</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>

<span class="n">df_above</span> <span class="o">=</span> <span class="n">gr</span><span class="o">.</span><span class="n">df_grid</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mu</span><span class="p">):</span>
    <span class="n">df_above</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">df_above</span>
        <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_bind_rows</span><span class="p">(</span><span class="n">gr</span><span class="o">.</span><span class="n">df_make</span><span class="p">(</span>
            <span class="n">X</span><span class="o">=</span><span class="n">mg_standard</span><span class="o">.</span><span class="n">r</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">m</span>
        <span class="p">))</span>
    <span class="p">)</span>
    
<span class="p">(</span>
    <span class="n">df_above</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_mutate</span><span class="p">(</span><span class="n">idx</span><span class="o">=</span><span class="n">DF</span><span class="o">.</span><span class="n">index</span> <span class="o">//</span> <span class="n">n</span><span class="p">)</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">pt_xbs</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;idx&quot;</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d22-e-stat06-spc-solution_39_0.png" src="../_images/d22-e-stat06-spc-solution_39_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (8763708698067)&gt;
</pre></div>
</div>
</div>
</div>
<p>Note that none of the observations exceed the upper control limit (UCL), but a “run” of many (9 or more) observations above the centerline is highly unlikely to be due to chance alone.</p>
</section>
<section id="runs-below-center">
<h2>Runs below center<a class="headerlink" href="#runs-below-center" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display
<span class="c1">## NOTE: No need to edit</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">mu</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">15</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">15</span> 
<span class="n">mg_standard</span> <span class="o">=</span> <span class="n">gr</span><span class="o">.</span><span class="n">marg_mom</span><span class="p">(</span><span class="s2">&quot;norm&quot;</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sd</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>

<span class="n">df_below</span> <span class="o">=</span> <span class="n">gr</span><span class="o">.</span><span class="n">df_grid</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mu</span><span class="p">):</span>
    <span class="n">df_below</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">df_below</span>
        <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_bind_rows</span><span class="p">(</span><span class="n">gr</span><span class="o">.</span><span class="n">df_make</span><span class="p">(</span>
            <span class="n">X</span><span class="o">=</span><span class="n">mg_standard</span><span class="o">.</span><span class="n">r</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">m</span>
        <span class="p">))</span>
    <span class="p">)</span>
    
<span class="p">(</span>
    <span class="n">df_below</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_mutate</span><span class="p">(</span><span class="n">idx</span><span class="o">=</span><span class="n">DF</span><span class="o">.</span><span class="n">index</span> <span class="o">//</span> <span class="n">n</span><span class="p">)</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">pt_xbs</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;idx&quot;</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d22-e-stat06-spc-solution_42_0.png" src="../_images/d22-e-stat06-spc-solution_42_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (8763709073960)&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="runs-increasing">
<h2>Runs increasing<a class="headerlink" href="#runs-increasing" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display
<span class="c1">## NOTE: No need to edit</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">mu</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">gr</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span> <span class="o">+</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span>
<span class="n">mg_standard</span> <span class="o">=</span> <span class="n">gr</span><span class="o">.</span><span class="n">marg_mom</span><span class="p">(</span><span class="s2">&quot;norm&quot;</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sd</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="n">df_increase</span> <span class="o">=</span> <span class="n">gr</span><span class="o">.</span><span class="n">df_grid</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mu</span><span class="p">):</span>
    <span class="n">df_increase</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">df_increase</span>
        <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_bind_rows</span><span class="p">(</span><span class="n">gr</span><span class="o">.</span><span class="n">df_make</span><span class="p">(</span>
            <span class="n">X</span><span class="o">=</span><span class="n">mg_standard</span><span class="o">.</span><span class="n">r</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">m</span>
        <span class="p">))</span>
    <span class="p">)</span>
    
<span class="p">(</span>
    <span class="n">df_increase</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_mutate</span><span class="p">(</span><span class="n">idx</span><span class="o">=</span><span class="n">DF</span><span class="o">.</span><span class="n">index</span> <span class="o">//</span> <span class="n">n</span><span class="p">)</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">pt_xbs</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;idx&quot;</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d22-e-stat06-spc-solution_44_0.png" src="../_images/d22-e-stat06-spc-solution_44_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (8763724211703)&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="runs-decreasing">
<h2>Runs decreasing<a class="headerlink" href="#runs-decreasing" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display
<span class="c1">## NOTE: No need to edit</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">mu</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">gr</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span> <span class="o">+</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span>
<span class="n">mg_standard</span> <span class="o">=</span> <span class="n">gr</span><span class="o">.</span><span class="n">marg_mom</span><span class="p">(</span><span class="s2">&quot;norm&quot;</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sd</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="n">df_decrease</span> <span class="o">=</span> <span class="n">gr</span><span class="o">.</span><span class="n">df_grid</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mu</span><span class="p">):</span>
    <span class="n">df_decrease</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">df_decrease</span>
        <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_bind_rows</span><span class="p">(</span><span class="n">gr</span><span class="o">.</span><span class="n">df_make</span><span class="p">(</span>
            <span class="n">X</span><span class="o">=</span><span class="n">mg_standard</span><span class="o">.</span><span class="n">r</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">m</span>
        <span class="p">))</span>
    <span class="p">)</span>
    
<span class="p">(</span>
    <span class="n">df_decrease</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_mutate</span><span class="p">(</span><span class="n">idx</span><span class="o">=</span><span class="n">DF</span><span class="o">.</span><span class="n">index</span> <span class="o">//</span> <span class="n">n</span><span class="p">)</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">pt_xbs</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;idx&quot;</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d22-e-stat06-spc-solution_46_0.png" src="../_images/d22-e-stat06-spc-solution_46_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (8763688709133)&gt;
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="warnings">
<h1>Warnings<a class="headerlink" href="#warnings" title="Permalink to this headline">#</a></h1>
<p>While we should be on the lookout for patterns in a control chart, we should balance this out with a healthy dose of skepticism. The following two examples demonstrate cases where we would see patterns in a control chart that have no real meaning.</p>
<section id="beware-spurious-patterns">
<h2>Beware spurious patterns!<a class="headerlink" href="#beware-spurious-patterns" title="Permalink to this headline">#</a></h2>
<p>Note that <em>false patterns</em> can still occur based on random events. These false patterns become more likely with smaller batch sizes. For instance, let’s take a look at the completely random dataset from above, batched into tiny subgroups:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display
<span class="c1">## NOTE: No need to edit</span>

<span class="p">(</span>
    <span class="n">df_random</span> 
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_mutate</span><span class="p">(</span><span class="n">id_batch</span><span class="o">=</span><span class="n">DF</span><span class="o">.</span><span class="n">index</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">pt_xbs</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;id_batch&quot;</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d22-e-stat06-spc-solution_49_0.png" src="../_images/d22-e-stat06-spc-solution_49_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (8763688516666)&gt;
</pre></div>
</div>
</div>
</div>
<p>Note that a variety of “patterns” are detected, but these cannot possibly be due to any assignable causes: The data are completely random by construction. Using a larger batch size helps to protect us against being mislead by random patterns, but keep in mind that false detections are always possible!</p>
</section>
<section id="beware-meaningless-order">
<h2>Beware meaningless order<a class="headerlink" href="#beware-meaningless-order" title="Permalink to this headline">#</a></h2>
<p>Patterns based on order (such as high/low or increasing/decreasing runs) are meaningless when order of the group variable has no meaning. For instance, we can reorder the machine identifiers in <code class="docutils literal notranslate"><span class="pre">df_machines</span></code> to artificially create an increasing run:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display
<span class="c1">## NOTE: No need to edit</span>
<span class="p">(</span>
    <span class="n">df_machines</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_mutate</span><span class="p">(</span><span class="n">id_machine</span><span class="o">=</span><span class="n">gr</span><span class="o">.</span><span class="n">fct_reorder</span><span class="p">(</span><span class="n">DF</span><span class="o">.</span><span class="n">id_machine</span><span class="p">,</span> <span class="n">DF</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">fun</span><span class="o">=</span><span class="n">gr</span><span class="o">.</span><span class="n">mean</span><span class="p">))</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">pt_xbs</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;id_machine&quot;</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d22-e-stat06-spc-solution_52_0.png" src="../_images/d22-e-stat06-spc-solution_52_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (8763671402316)&gt;
</pre></div>
</div>
</div>
</div>
<p>Here the batch means are increasing, but that is only because we ordered the machines by their batch mean!</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="example-cast-aluminum-dataset">
<h1>Example: Cast Aluminum Dataset<a class="headerlink" href="#example-cast-aluminum-dataset" title="Permalink to this headline">#</a></h1>
<p>Let’s take a closer look at the cast aluminum dataset using our new lense of control charts.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">grama.data</span> <span class="kn">import</span> <span class="n">df_shewhart</span>
<span class="n">df_shewhart</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>specimen</th>
      <th>tensile_strength</th>
      <th>hardness</th>
      <th>density</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>29314</td>
      <td>53.0</td>
      <td>2.666</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>34860</td>
      <td>70.2</td>
      <td>2.708</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>36818</td>
      <td>84.3</td>
      <td>2.865</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>30120</td>
      <td>55.3</td>
      <td>2.627</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>34020</td>
      <td>78.5</td>
      <td>2.581</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We might want to use this data to model these material properties are random, but before that we should ask: Is the manufacturing process generating these properties under statistical control?</p>
<section id="q4-assess-the-density">
<h2><strong>q4</strong> Assess the <code class="docutils literal notranslate"><span class="pre">density</span></code><a class="headerlink" href="#q4-assess-the-density" title="Permalink to this headline">#</a></h2>
<p>Assess the state of statistical control for the variable <code class="docutils literal notranslate"><span class="pre">density</span></code> using a control chart.</p>
<p>Answer the questions under <em>observations</em> below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display
<span class="c1">## TODO: Construct batches and make a control chart</span>
<span class="p">(</span>
    <span class="n">df_shewhart</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_mutate</span><span class="p">(</span><span class="n">idx</span><span class="o">=</span><span class="n">DF</span><span class="o">.</span><span class="n">index</span> <span class="o">//</span> <span class="mi">3</span><span class="p">)</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">pt_xbs</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;idx&quot;</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d22-e-stat06-spc-solution_58_0.png" src="../_images/d22-e-stat06-spc-solution_58_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (8763671331271)&gt;
</pre></div>
</div>
</div>
</div>
<p><em>Observations</em></p>
<ul class="simple">
<li><p>What <em>assumptions</em> did you have to make in order to construct rational batches?</p>
<ul>
<li><p>To group observations into consecutive batches, we need to assume that the data are reported in the order they were collected.</p></li>
</ul>
</li>
<li><p>Based on the batch size you chose, did you find any out-of-control patterns? Did it occur in the <code class="docutils literal notranslate"><span class="pre">Variability</span></code> or batch <code class="docutils literal notranslate"><span class="pre">Mean</span></code>?</p>
<ul>
<li><p>At a batch size of <span class="math notranslate nohighlight">\(n=5\)</span>, I find no out-of-control patterns.</p></li>
<li><p>At a batch size of <span class="math notranslate nohighlight">\(n=3\)</span>, I <strong>do</strong> find out-of-control patterns (one case outside the UCL).</p></li>
</ul>
</li>
<li><p>If you answered “yes” to the previous question: Based on the batch size you chose, are those patterns likely to be spurious?</p>
<ul>
<li><p>For the <span class="math notranslate nohighlight">\(n=3\)</span> case, this is a very small batch size; the out-of-control case could be spurious.</p></li>
</ul>
</li>
<li><p>Is the <code class="docutils literal notranslate"><span class="pre">density</span></code> likely to be under statistical control?</p>
<ul>
<li><p>Yes; I find no evidence of out-of-control behavior.</p></li>
</ul>
</li>
</ul>
<!-- solution-end --></section>
<section id="q5-assess-the-tensile-strength">
<h2><strong>q5</strong> Assess the <code class="docutils literal notranslate"><span class="pre">tensile_strength</span></code><a class="headerlink" href="#q5-assess-the-tensile-strength" title="Permalink to this headline">#</a></h2>
<p>Assess the state of statistical control for the variable <code class="docutils literal notranslate"><span class="pre">tensile_strength</span></code> using a control chart.</p>
<p>Answer the questions under <em>observations</em> below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display
<span class="c1">## TODO: Construct batches and make a control chart</span>
<span class="p">(</span>
    <span class="n">df_shewhart</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_mutate</span><span class="p">(</span><span class="n">idx</span><span class="o">=</span><span class="n">DF</span><span class="o">.</span><span class="n">index</span> <span class="o">//</span> <span class="mi">5</span><span class="p">)</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">pt_xbs</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;idx&quot;</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s2">&quot;tensile_strength&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d22-e-stat06-spc-solution_61_0.png" src="../_images/d22-e-stat06-spc-solution_61_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (8763708832208)&gt;
</pre></div>
</div>
</div>
</div>
<p><em>Observations</em></p>
<ul class="simple">
<li><p>What <em>assumptions</em> did you have to make in order to construct rational batches?</p>
<ul>
<li><p>To group observations into consecutive batches, we need to assume that the data are reported in the order they were collected.</p></li>
</ul>
</li>
<li><p>Based on the batch size you chose, did you find any out-of-control patterns? Did it occur in the <code class="docutils literal notranslate"><span class="pre">Variability</span></code> or batch <code class="docutils literal notranslate"><span class="pre">Mean</span></code>?</p>
<ul>
<li><p>Yes; at a batch size of <code class="docutils literal notranslate"><span class="pre">n=5</span></code> I found the mean to violate the LCL.</p></li>
</ul>
</li>
<li><p>If you answered “yes” to the previous question: Based on the batch size you chose, are those patterns likely to be spurious?</p>
<ul>
<li><p>Possibly; <code class="docutils literal notranslate"><span class="pre">n=5</span></code> is a very small batch size, so this could certainly be due to chance.</p></li>
</ul>
</li>
<li><p>Is the <code class="docutils literal notranslate"><span class="pre">tensile_strength</span></code> likely to be under statistical control?</p>
<ul>
<li><p>Possibly; I find that the below LCL batch mean persists for batch sizes of <code class="docutils literal notranslate"><span class="pre">n=6,7,8,9</span></code>, which suggests the process may have been out of control for some of the earlier runs. However, the below LCL case disappears for <code class="docutils literal notranslate"><span class="pre">n=10</span></code>; it is possible that this pattern is spurious.</p></li>
</ul>
</li>
</ul>
<!-- solution-end --></section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="references">
<h1>References<a class="headerlink" href="#references" title="Permalink to this headline">#</a></h1>
<ul class="simple">
<li><p>Kenett and Zacks, <em>Modern Industrial Statistics</em>, 2nd Edition (2014)</p></li>
</ul>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./exercises_solution"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="d21-e-stat05-CI-solution.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Stats: Confidence Intervals and the CLT</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="d23-e-grama06-fit-univar-solution.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Grama: Fitting Univariate Distributions</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Zachary del Rosario<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>